<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xinyao.mapper.fund.AmountDetailDao">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.xinyao.bean.fund.AmountDetail">
        <id column="id" property="id" />
        <result column="user_id" property="userId" />
        <result column="user_name" property="userName" />
        <result column="order_id" property="orderId" />
        <result column="order_sn" property="orderSn" />
        <result column="type" property="type" />
        <result column="operation_symbol" property="operationSymbol" />
        <result column="amount" property="amount" />
        <result column="create_id" property="createId" />
        <result column="create_time" property="createTime" />
        <result column="create_name" property="createName" />
        <result column="status" property="status" />
        <result column="comment" property="comment" />
        <result column="transaction_num" property="transactionNum" />
        <result column="transaction_date" property="transactionDate" />
        <result column="bank_card" property="bankCard" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, user_id, user_name, order_id, order_sn, type, operation_symbol, amount, create_id, create_time, create_name, status, comment, transaction_num, transaction_date, bank_card
    </sql>


    <insert id="insertSelective" keyColumn="id" keyProperty="id" parameterType="com.xinyao.bean.Bo.fundBo.AmountDetaliBo" useGeneratedKeys="true">
        insert into fund_amount_detail
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                user_id,
            </if>
            <if test="userName != null">
                `user_name`,
            </if>
            <if test="type != null">
                `type`,
            </if>
            <if test="bankCard != null">
                bank_card,
            </if>
            <if test="amount != null">
                amount,
            </if>
                create_time,
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                #{userId,jdbcType=INTEGER},
            </if>
            <if test="userName != null">
                #{userName},
            </if>
            <if test="type != null">
                #{type,jdbcType=VARCHAR},
            </if>
            <if test="bankCard != null">
                #{bankCard},
            </if>
            <if test="amount != null">
                #{amount},
            </if>
            now(),
        </trim>
    </insert>

    <select id="GetMoneny" resultType="double">
        SELECT amount FROM usc_user WHERE id = #{id}
    </select>


    <update id="recharge">
        update usc_user
        set amount = #{amount}
        where id = #{userId}
    </update>
    <update id="withdrawal">
        update usc_user
        set amount = #{amount}
        where id = #{userId}
    </update>


    <select id="flowinGlist" resultType="com.xinyao.bean.Vo.AmountDetailVo">
        SELECT amount,comment,transaction,create_time as createTime from fund_amount_detail
        where 1 = 1
        <if test="userId != null">
            AND user_id = #{userId}
        </if>
        <if test="transaction != null and transaction!= 0">
            AND transaction LIKE CONCAT('%',#{transaction},'%')
        </if>
        LIMIT #{page},#{pageSize}
    </select>

    <select id="ConutflowinGlist" resultType="int">
        select count(1) from fund_amount_detail
        where 1 = 1
        <if test="userId != null">
            AND user_id = #{userId}
        </if>
        <if test="transaction != null and transaction!= 0">
            AND transaction LIKE CONCAT('%',#{transaction},'%')
        </if>
    </select>
</mapper>
